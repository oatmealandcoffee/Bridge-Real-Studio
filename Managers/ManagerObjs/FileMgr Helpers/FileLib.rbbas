#tag ModuleProtected Module FileLib	#tag Method, Flags = &h21		Private Function CreateNewWindow() As Boolean		  		  if NewEditor <> nil then 		    return true		  end if		  		  return false		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function ModalSaveAsDialog(Editor as WindowEditor, mFileType as string, mFileName as string) As FolderItem		  Dim mSaveAsDialog as New SaveAsDialog		  Dim f as FolderItem		  		  mSaveAsDialog.InitialDirectory = SpecialFolder.Documents		  'mSaveAsDialog.promptText = "Prompt Text"		  mSaveAsDialog.SuggestedFileName = mFileName		  mSaveAsDialog.Title = Editor.Name		  mSaveAsDialog.Filter = mFileType		  		  return mSaveAsDialog.ShowModalWithin(Editor)		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub Open()		  NativeFile = GetOpenFolderItem(FileTypes1.TextXml)		  		  If NativeFile <> nil then		    		    WindowMgr.EditorNew		    WindowMgr.CurrentEditor.Show		    		    WindowMgr.CurrentEditor.FileMgr.NativeFile = NativeFile		    WindowMgr.CurrentEditor.FileMgr.Open		    WindowMgr.CurrentEditor.ResizeBars		    		    WindowMgr.CurrentEditor.TrackListObj1.Update		    		  else		    MsgBox "There was a problem making a new window. You may have met the limit for your license."		  end if		  		  NativeFile = nil		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function PrettyPrint(TheXML as XMLDocument) As String		  return TheXML.Transform(kXSL_PrettyPrint)		End Function	#tag EndMethod	#tag Property, Flags = &h1		Protected NativeFile As FolderItem	#tag EndProperty	#tag Constant, Name = kFileExtension_MIDI, Type = String, Dynamic = False, Default = \"mid", Scope = Protected	#tag EndConstant	#tag Constant, Name = kFileExtension_Native, Type = String, Dynamic = False, Default = \"xml", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Application_Name, Type = String, Dynamic = False, Default = \"application_name", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Application_Node, Type = String, Dynamic = False, Default = \"application", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Application_Version, Type = String, Dynamic = False, Default = \"application_version", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ChordObj_Node, Type = String, Dynamic = False, Default = \"chord_obj", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ChordObj_Note, Type = String, Dynamic = False, Default = \"chord_note", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ChordObj_Notes, Type = String, Dynamic = False, Default = \"chord_notes", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ChordObj_Root, Type = String, Dynamic = False, Default = \"chord_root", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ChordObj_RootIndex, Type = String, Dynamic = False, Default = \"chord_rootindex", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ChordObj_Settings, Type = String, Dynamic = False, Default = \"chord_settings", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ChordObj_StepValue, Type = String, Dynamic = False, Default = \"chord_stepvalue", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ChordObj_StepValues, Type = String, Dynamic = False, Default = \"chord_stepvalues", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ChordObj_Type, Type = String, Dynamic = False, Default = \"chord_type", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Datatype_Boolean_False, Type = String, Dynamic = False, Default = \"F", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Datatype_Boolean_True, Type = String, Dynamic = False, Default = \"T", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_DataType_Color, Type = String, Dynamic = False, Default = \"color", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_DataType_Color_Blue, Type = String, Dynamic = False, Default = \"color_blue", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_DataType_Color_Green, Type = String, Dynamic = False, Default = \"color_green", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_DataType_Color_Red, Type = String, Dynamic = False, Default = \"color_red", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Editor_NewNoteValue, Type = String, Dynamic = False, Default = \"editor_newnotevalue", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Editor_Node, Type = String, Dynamic = False, Default = \"editor", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Editor_ScrollX_Maximum, Type = String, Dynamic = False, Default = \"editor_scrollx_maximum", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Editor_Scroll_X, Type = String, Dynamic = False, Default = \"editor_scrollx", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Editor_Scroll_Y, Type = String, Dynamic = False, Default = \"editor_scrolly", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Editor_SnapToValue, Type = String, Dynamic = False, Default = \"editor_snaptovalue", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Editor_Zoom_X, Type = String, Dynamic = False, Default = \"editor_zoomx", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Editor_Zoom_Y, Type = String, Dynamic = False, Default = \"editor_zoomy", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_GroupObj_Node, Type = String, Dynamic = False, Default = \"group_obj", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_GroupObj_Objects_Node, Type = String, Dynamic = False, Default = \"group_objects", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_GUIObj_Node, Type = String, Dynamic = False, Default = \"guiobj", Scope = Public	#tag EndConstant	#tag Constant, Name = kXML_GUIObj_SnapTo, Type = String, Dynamic = False, Default = \"guiobj_snapto", Scope = Public	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_Constant, Type = String, Dynamic = False, Default = \"key_constant", Scope = Public	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_Modifer, Type = String, Dynamic = False, Default = \"key_modifier", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_Node, Type = String, Dynamic = False, Default = \"key_obj", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_Pitch, Type = String, Dynamic = False, Default = \"key_pitch", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_PitchesBuffer_Node, Type = String, Dynamic = False, Default = \"key_pitchesbuffer", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_Pitches_Node, Type = String, Dynamic = False, Default = \"key_pitches", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_Settings, Type = String, Dynamic = False, Default = \"key_settings", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_SongMgr, Type = String, Dynamic = False, Default = \"key_songmgr", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_StartBeat, Type = String, Dynamic = False, Default = \"key_startbeat", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_StepValue, Type = String, Dynamic = False, Default = \"key_stepvalue", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_StepValueString_Node, Type = String, Dynamic = False, Default = \"key_stepvalues", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_Tonic, Type = String, Dynamic = False, Default = \"key_tonic", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_KeyObj_TonicName, Type = String, Dynamic = False, Default = \"key_tonicname", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Keys_Node, Type = String, Dynamic = False, Default = \"keys", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_Group, Type = String, Dynamic = False, Default = \"musicobj_group", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_Hidden, Type = String, Dynamic = False, Default = \"musicobj_hidden", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_ID, Type = String, Dynamic = False, Default = \"musicobj_id", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_Label, Type = String, Dynamic = False, Default = \"musicobj_label", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_Length, Type = String, Dynamic = False, Default = \"musicobj_length", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_Locked, Type = String, Dynamic = False, Default = \"musicobj_locked", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_Name, Type = String, Dynamic = False, Default = \"musicobj_name", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_OldLength, Type = String, Dynamic = False, Default = \"musicobj_oldlength", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_OldStartBeat, Type = String, Dynamic = False, Default = \"musicobj_oldstartbeat", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_Selected, Type = String, Dynamic = False, Default = \"musicobj_selected", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_StartBeat, Type = String, Dynamic = False, Default = \"musicobj_startbeat", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_Track, Type = String, Dynamic = False, Default = \"musicobj_track", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_MusicObj_Velocity, Type = String, Dynamic = False, Default = \"musicobj_velocity", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_NoteMgr_Chords_Node, Type = String, Dynamic = False, Default = \"chords", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_NoteMgr_Groups_Node, Type = String, Dynamic = False, Default = \"groups", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_NoteMgr_NewNoteLength, Type = String, Dynamic = False, Default = \"newnotelength", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_NoteMgr_Node, Type = String, Dynamic = False, Default = \"notemgr", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_NoteMgr_Notes_Node, Type = String, Dynamic = False, Default = \"notes", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_NoteObj_Chord, Type = String, Dynamic = False, Default = \"note_chord", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_NoteObj_NextNote, Type = String, Dynamic = False, Default = \"note_nextnote", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_NoteObj_Node, Type = String, Dynamic = False, Default = \"note_obj", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_NoteObj_OldPitch, Type = String, Dynamic = False, Default = \"note_oldpitch", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_NoteObj_Pitch, Type = String, Dynamic = False, Default = \"note_currentpitch", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_NoteObj_PreviousNote, Type = String, Dynamic = False, Default = \"note_previousnote", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ObjectType_Chord, Type = String, Dynamic = False, Default = \"C", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ObjectType_Group, Type = String, Dynamic = False, Default = \"G", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_ObjectType_Note, Type = String, Dynamic = False, Default = \"N", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Object_ID, Type = String, Dynamic = False, Default = \"generic_objectid", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Object_Node, Type = String, Dynamic = False, Default = \"generic_object", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Object_Type, Type = String, Dynamic = False, Default = \"generic_objecttype", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_PlayMgr_EditCursorStart, Type = String, Dynamic = False, Default = \"playmgr_editcursor_start", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_PlayMgr_Loop, Type = String, Dynamic = False, Default = \"playmgr_loop", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_PlayMgr_LoopStartCursorStart, Type = String, Dynamic = False, Default = \"playmgr_loopstartcursor_start", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_PlayMgr_LoopStopCursorStart, Type = String, Dynamic = False, Default = \"playmgr_loopstopcursor_start", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_PlayMgr_Node, Type = String, Dynamic = False, Default = \"playmgr", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_PlayMgr_StartCursorStart, Type = String, Dynamic = False, Default = \"playmgr_startcursor_start", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_PlayMgr_StopCursorStart, Type = String, Dynamic = False, Default = \"playmgr_stopcursor_start", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Root_Node, Type = String, Dynamic = False, Default = \"data_root", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_SongMgr_Node, Type = String, Dynamic = False, Default = \"songmgr", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_SongMgr_Tempo, Type = String, Dynamic = False, Default = \"tempo", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_SongMgr_TimeSignatureBasicBeat, Type = String, Dynamic = False, Default = \"timesignaturebasicbeat", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_SongMgr_TimeSignatureBeatsPerMeasure, Type = String, Dynamic = False, Default = \"timesignaturebeatspermeasure", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_SongMgr_TotalBeats, Type = String, Dynamic = False, Default = \"totalbeats", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_TrackMgr_ColorIndex, Type = String, Dynamic = False, Default = \"colorindex", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_TrackMgr_Node, Type = String, Dynamic = False, Default = \"track_mgr", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Tracks_Node, Type = String, Dynamic = False, Default = \"tracks", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_ID, Type = String, Dynamic = False, Default = \"track_id", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_Instrument, Type = String, Dynamic = False, Default = \"track_instrument", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_Label, Type = String, Dynamic = False, Default = \"track_label", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_Name, Type = String, Dynamic = False, Default = \"track_Name", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_Node, Type = String, Dynamic = False, Default = \"track_obj", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_Objects_Node, Type = String, Dynamic = False, Default = \"track_objects", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_Object_ID, Type = String, Dynamic = False, Default = \"track_objectid", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_Object_Node, Type = String, Dynamic = False, Default = \"track_object", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_Object_Type, Type = String, Dynamic = False, Default = \"track_objecttype", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_Play, Type = String, Dynamic = False, Default = \"track_play", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_Visible, Type = String, Dynamic = False, Default = \"track_visible", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXML_Track_VisualCue, Type = String, Dynamic = False, Default = \"track_visualcue", Scope = Protected	#tag EndConstant	#tag Constant, Name = kXSL_PrettyPrint, Type = String, Dynamic = False, Default = \"<\?xml version\x3D\"1.0\" encoding\x3D\"UTF-8\"\?><xsl:transform version\x3D\"1.0\" xmlns:xsl\x3D\"http://www.w3.org/1999/XSL/Transform\"><xsl:output method\x3D\"xml\" indent\x3D\"yes\" /><xsl:template match\x3D\"/\"><xsl:copy-of select\x3D\"/\" /></xsl:template></xsl:transform>", Scope = Protected	#tag EndConstant	#tag ViewBehavior		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Module#tag EndModule