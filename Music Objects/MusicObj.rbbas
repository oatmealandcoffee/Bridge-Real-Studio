#tag ClassProtected Class MusicObj	#tag Method, Flags = &h0		Sub Constructor()		  MusicObjCount = ObjectCount		  Description = Str(MusicObjCount)		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function IsAltered() As Boolean		  if CommandBufferLength <> OldLength then return true		  if CommandBufferPitch <> OldPitch then return true		  if CommandBufferStartBeat <> StartBeat then return true		  		  return false		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub SetOldData()		  //called from NoteMgr.EditNote to ensure dragged items stay in formation		  //called from NoteMgr.AddSelectionFromNote to get the initial values in case we go straight to drag.		  		  CommandBufferLength = Length		  CommandBufferPitch = Pitch		  CommandBufferStartBeat = StartBeat		  		  OldStartBeat = StartBeat		  OldPitch = Pitch		  OldLength = Length		End Sub	#tag EndMethod	#tag Property, Flags = &h21		Private CommandBufferLength As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private CommandBufferPitch As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private CommandBufferStartBeat As Integer	#tag EndProperty	#tag ComputedProperty, Flags = &h0		#tag Getter			Get			  if Selected then return mDescription + "*"			  			  return mDescription			End Get		#tag EndGetter		#tag Setter			Set			  mDescription = value			End Set		#tag EndSetter		Description As String	#tag EndComputedProperty	#tag Property, Flags = &h0		Group As GroupObj	#tag EndProperty	#tag Property, Flags = &h0		Hidden As Integer	#tag EndProperty	#tag Property, Flags = &h0		#tag Note			ID is at file saving. It is simply an object's index in its respective array.		#tag EndNote		ID As String	#tag EndProperty	#tag Property, Flags = &h0		#tag Note			label is what it shown in the help popups		#tag EndNote		Label As String	#tag EndProperty	#tag Property, Flags = &h0		Length As Integer	#tag EndProperty	#tag Property, Flags = &h0		Locked As Boolean	#tag EndProperty	#tag Property, Flags = &h21		#tag Note			This the unique ID for trouble shooting		#tag EndNote		Private mDescription As String	#tag EndProperty	#tag Property, Flags = &h21		Private MusicObjCount As Integer	#tag EndProperty	#tag Property, Flags = &h0		Name As String	#tag EndProperty	#tag Property, Flags = &h0		#tag Note			[ ] This is a note array that tracks only the notes and not grouping objects like ChordObj and GroupObj.			[ ] The NoteList is managed in the object creation methods for both ChordObjs and GroupObjs.			[ ] The purpose of the NoteList is to buffer all of the notes within a MusicObj for drag selection purposes.			[ ] Edits should not use this list and instead go down the object hierarchy. 			[ ] This maintains the consistency of the methods for object management (e.g. group/ungroup) and edits.		#tag EndNote		NoteList(-1) As NoteObj	#tag EndProperty	#tag ComputedProperty, Flags = &h21		#tag Getter			Get			  if ParentWindow <> nil then			    return ParentWindow.NoteMgr			  end if			End Get		#tag EndGetter		Private NoteMgr As NoteMgrObj	#tag EndComputedProperty	#tag Property, Flags = &h0		OldLength As Integer	#tag EndProperty	#tag Property, Flags = &h0		OldPitch As Integer	#tag EndProperty	#tag Property, Flags = &h0		OldStartBeat As Integer	#tag EndProperty	#tag ComputedProperty, Flags = &h21		#tag Getter			Get			  if Track <> nil then			    return Track.TrackList.ParentWindow			  end if			End Get		#tag EndGetter		Private ParentWindow As WindowEditor	#tag EndComputedProperty	#tag Property, Flags = &h0		Pitch As Integer	#tag EndProperty	#tag Property, Flags = &h0		Selected As Boolean = False	#tag EndProperty	#tag Property, Flags = &h0		StartBeat As Integer	#tag EndProperty	#tag Property, Flags = &h0		Track As TrackObj	#tag EndProperty	#tag Property, Flags = &h0		Velocity As Integer = 60	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="Description"			Group="Behavior"			Type="String"			EditorType="MultiLineEditor"		#tag EndViewProperty		#tag ViewProperty			Name="Hidden"			Group="Behavior"			InitialValue="0"			Type="Integer"		#tag EndViewProperty		#tag ViewProperty			Name="ID"			Group="Behavior"			InitialValue="0"			Type="String"			EditorType="MultiLineEditor"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Label"			Group="Behavior"			Type="String"			EditorType="MultiLineEditor"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Length"			Group="Behavior"			InitialValue="0"			Type="Integer"		#tag EndViewProperty		#tag ViewProperty			Name="Locked"			Group="Behavior"			InitialValue="0"			Type="Boolean"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="OldLength"			Group="Behavior"			InitialValue="0"			Type="Integer"		#tag EndViewProperty		#tag ViewProperty			Name="OldPitch"			Group="Behavior"			InitialValue="0"			Type="Integer"		#tag EndViewProperty		#tag ViewProperty			Name="OldStartBeat"			Group="Behavior"			InitialValue="0"			Type="Integer"		#tag EndViewProperty		#tag ViewProperty			Name="Pitch"			Group="Behavior"			InitialValue="0"			Type="Integer"		#tag EndViewProperty		#tag ViewProperty			Name="Selected"			Group="Behavior"			InitialValue="0"			Type="Boolean"		#tag EndViewProperty		#tag ViewProperty			Name="StartBeat"			Group="Behavior"			InitialValue="0"			Type="Integer"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Velocity"			Group="Behavior"			InitialValue="60"			Type="Integer"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass