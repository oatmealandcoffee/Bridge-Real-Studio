#tag WindowBegin Window WindowEditor   BackColor       =   16777215   Backdrop        =   ""   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   640   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   True   MaxWidth        =   32000   MenuBar         =   1179086674   MenuBarVisible  =   True   MinHeight       =   480   MinimizeButton  =   True   MinWidth        =   777   Placement       =   0   Resizeable      =   True   Title           =   "MusicSketch - Main Editor"   Visible         =   True   Width           =   1280   Begin GUIObj GUIObj1      AcceptFocus     =   True      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   488      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   236      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Top             =   80      UseFocusRing    =   True      Visible         =   True      Width           =   1024   End   Begin TrackListObj TrackListObj1      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   1      ColumnsResizable=   ""      ColumnWidths    =   ""      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   -1      Enabled         =   True      EnableDrag      =   False      EnableDragReorder=   True      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   ""      HeadingIndex    =   -1      Height          =   488      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   -1      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      RequiresSelection=   True      Scope           =   0      ScrollbarHorizontal=   True      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   80      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   225      _ScrollOffset   =   0      _ScrollWidth    =   -1   End   Begin ScrollBar yScrollBar      AcceptFocus     =   true      AutoDeactivate  =   True      Enabled         =   True      Height          =   378      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   1260      LineStep        =   1      LiveScroll      =   True      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   False      LockRight       =   True      LockTop         =   True      Maximum         =   127      Minimum         =   0      PageStep        =   12      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Top             =   190      Value           =   47      Visible         =   True      Width           =   17   End   Begin ScrollBar xScrollBar      AcceptFocus     =   true      AutoDeactivate  =   True      Enabled         =   True      Height          =   17      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   348      LineStep        =   40      LiveScroll      =   True      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   False      Maximum         =   0      Minimum         =   0      PageStep        =   40      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Top             =   568      Value           =   0      Visible         =   True      Width           =   912   End   Begin BevelButton BButtonNoteAdd      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   ""      Bevel           =   0      Bold            =   False      ButtonType      =   1      Caption         =   "Add"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   ""      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   236      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   ""      TextFont        =   "System"      TextSize        =   0      TextUnit        =   ""      Top             =   45      Underline       =   False      Value           =   False      Visible         =   True      Width           =   60   End   Begin BevelButton BButtonNoteDelete      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   ""      Bevel           =   0      Bold            =   False      ButtonType      =   1      Caption         =   "Delete"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   ""      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   380      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   ""      TextFont        =   "System"      TextSize        =   0      TextUnit        =   ""      Top             =   45      Underline       =   False      Value           =   False      Visible         =   True      Width           =   60   End   Begin BevelButton BButtonNoteEdit      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   ""      Bevel           =   0      Bold            =   False      ButtonType      =   1      Caption         =   "Edit"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   ""      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   308      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   ""      TextFont        =   "System"      TextSize        =   0      TextUnit        =   ""      Top             =   45      Underline       =   False      Value           =   False      Visible         =   True      Width           =   60   End   Begin BevelButton BButtonNoteLock      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   ""      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "Lock/Unlock"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   ""      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   452      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   ""      TextFont        =   "System"      TextSize        =   0      TextUnit        =   ""      Top             =   45      Underline       =   False      Value           =   False      Visible         =   True      Width           =   100   End   Begin BevelButton BButtonTrackAdd      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   ""      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "Add"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   ""      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   ""      TextFont        =   "System"      TextSize        =   0      TextUnit        =   ""      Top             =   45      Underline       =   False      Value           =   False      Visible         =   True      Width           =   50   End   Begin BevelButton BButtonTrackDelete      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   ""      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "Delete"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   ""      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   82      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   ""      TextFont        =   "System"      TextSize        =   0      TextUnit        =   ""      Top             =   45      Underline       =   False      Value           =   False      Visible         =   True      Width           =   50   End   Begin Slider SliderZoomX      AutoDeactivate  =   True      Enabled         =   True      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   236      LineStep        =   1      LiveScroll      =   True      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   ""      Maximum         =   16      Minimum         =   1      PageStep        =   4      Scope           =   0      TabIndex        =   10      TabPanelIndex   =   0      TabStop         =   True      TickStyle       =   0      Top             =   571      Value           =   2      Visible         =   True      Width           =   100   End   Begin Slider SliderZoomY      AutoDeactivate  =   True      Enabled         =   True      Height          =   100      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   1264      LineStep        =   1      LiveScroll      =   True      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   True      LockTop         =   True      Maximum         =   32      Minimum         =   8      PageStep        =   4      Scope           =   0      TabIndex        =   11      TabPanelIndex   =   0      TabStop         =   True      TickStyle       =   0      Top             =   78      Value           =   16      Visible         =   True      Width           =   16   End   Begin PopupMenu PM_NewNoteLength      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   585      ListIndex       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   12      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   45      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PopupMenu PM_SnapTo      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   677      ListIndex       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   13      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   45      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PopupMenu PM_BeatsPerMeasure      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   308      ListIndex       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   14      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   598      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PopupMenu PM_BasicBeat      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   485      ListIndex       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   15      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   598      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin StaticText ST_NewNoteLength      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   585      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      TabIndex        =   16      TabPanelIndex   =   0      Text            =   "New Note"      TextAlign       =   1      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   13      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin StaticText ST_SnapTo      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   677      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      TabIndex        =   17      TabPanelIndex   =   0      Text            =   "Snap To"      TextAlign       =   1      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   13      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin StaticText ST_BeatsPerMeasure      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   169      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   18      TabPanelIndex   =   0      Text            =   "Beats per Measure"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   598      Underline       =   ""      Visible         =   True      Width           =   127   End   Begin StaticText ST_BasicBeat      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   400      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   19      TabPanelIndex   =   0      Text            =   "Basic Beat"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   599      Underline       =   ""      Visible         =   True      Width           =   73   End   Begin PushButton Play_PB      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "Play"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   705      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   20      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   599      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin StaticText ST_Tempo      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   22      TabPanelIndex   =   0      Text            =   "Tempo"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   599      Underline       =   ""      Visible         =   True      Width           =   60   End   Begin TextField Tempo_EF      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   92      LimitText       =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   ""      Mask            =   "###"      Multiline       =   ""      Password        =   ""      ReadOnly        =   True      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   ""      TabIndex        =   23      TabPanelIndex   =   0      TabStop         =   True      Text            =   120      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   597      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   54   End   Begin UpDownArrows Tempo_UDA      AcceptFocus     =   False      AutoDeactivate  =   True      Enabled         =   True      Height          =   23      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   150      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   24      TabPanelIndex   =   0      TabStop         =   True      Top             =   597      Visible         =   True      Width           =   13   End   Begin BevelButton BButtonTrackDupe      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   ""      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "Dupe"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   ""      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   144      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   27      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   ""      TextFont        =   "System"      TextSize        =   0      TextUnit        =   ""      Top             =   45      Underline       =   False      Value           =   False      Visible         =   True      Width           =   50   End   Begin CheckBox Loop_Check      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Loop"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   797      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   ""      Scope           =   0      State           =   0      TabIndex        =   29      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   599      Underline       =   ""      Value           =   False      Visible         =   True      Width           =   100   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Activate()		  WindowMgr.EditorSetCurrent(me)		End Sub	#tag EndEvent	#tag Event		Sub Close()		  if WindowMgr.ApplicationQuitFlag = false then		    dim CloseMe as Boolean = WindowMgr.EditorClose(me)		  end if		End Sub	#tag EndEvent	#tag Event		Sub EnableMenuItems()		   NewEditor.Enable //need to check demo limits		  NewTrack.Enable //need to check channel and demo limits		  		  if self.WindowNeedsSaving then		    SaveSave.Enable		  end if		  		  if self.FileMgr.NativeFile <> nil then		    FileRevertToSaved.Enable		  end if		  		  if Ubound(WindowMgr.Editors) > -1 then		    FileSaveAll.Enable		  end if		  		  if Ubound(NoteMgr.Notes) > -1 then		    EditSelectAll.Enable		    NotesGroup.Enable		  end if		  		  if Ubound(NoteMgr.Selection) > -1 then		    EditSelectNone.Enable		    		    NotesMakeChord.Enable		    NotesRemoveChord.Enable		    NotesBreakChord.Enable		    NotesAlterChord.Enable		    		    NotesLockUnlock.Enable		    		    If SelectionHasGroup then		      NotesUngroup.Enable		    End If		    		  end if		  		  if CommandMgr.CanUndo then		    EditUndo.Enable		    EditUndo.Text = "Undo " + CommandMgr.CurrentUndoName		  else		    EditUndo.Text = "Can't Undo"		  end if		  		  if CommandMgr.CanRedo then		    EditRedo.Enable		    EditRedo.Text = "Redo " + CommandMgr.CurrentRedoName		  else		    EditRedo.Text = "Can't Redo"		  end if		  		  //ALWAYS ON		  SaveSaveAs.Enable		  FileExportasMIDI.Enable		  MusicSetStopCursorToEnd.Enable		  MusicLoopEntireSong.Enable		  		End Sub	#tag EndEvent	#tag Event		Sub Open()		  //do an initial check		  Open_IfAppOpening		  		  //set up the necessary links for other commands		  Open_InitializeMgrs		  Open_InitializeControlLinks		  		  //give them a default track to work with		  TrackListObj1.AddTrack		  		  //set up a basic song		  Open_InitializeSongMgr		  		  //set up the controls		  Open_Initialize_PM_BeatsPerMeasure		  Open_Initialize_PM_BasicBeat		  Open_Initialize_PM_NewNoteLength		  Open_Initialize_PM_SnapTo		  Open_InitializeGUIObjParameters		  Open_InitializeScrollBars		  		  //release the control holds (lots of NilObjectExceptions and controls not existing yet)		  App.Opening = false		  		  //update the UI		  ResizeBars		  Tempo_EF.Text = Str(SongMgr.Tempo)		  		  me.WindowNeedsSaving = false		  		  If SplashWindow.Visible = true then SplashWindow.Close		  		  me.Refresh		  		  #if DebugBuild		    'TestSuite.NewWindowCommand		  #endif		End Sub	#tag EndEvent	#tag Event		Sub Resized()		  ResizeBars		End Sub	#tag EndEvent	#tag Event		Sub Resizing()		  ResizeBars		End Sub	#tag EndEvent	#tag MenuHandler		Function CreateSimpleRandomMelody() As Boolean Handles CreateSimpleRandomMelody.Action			WindowACSBasicSequence.ParentWindow = me						WindowACSBasicSequence.Show						WindowACSBasicSequence.SetControls						GUIObj1.Draw						Return True		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditClear() As Boolean Handles EditClear.Action			#if kLogMethods			Log("WindowEditor.Menu.Edit.Clear")			#endif						EditMgr.Delete			GUIObj1.Draw						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditCopy() As Boolean Handles EditCopy.Action			EditMgr.Copy						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditCut() As Boolean Handles EditCut.Action			EditMgr.Cut			GUIObj1.Draw						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditorClose() As Boolean Handles EditorClose.Action			dim CloseMe as Boolean = WindowMgr.EditorClose(me)						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditPaste() As Boolean Handles EditPaste.Action			EditMgr.Paste			GUIObj1.Draw						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditRedo() As Boolean Handles EditRedo.Action			CommandMgr.Redo						Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditSelectAll() As Boolean Handles EditSelectAll.Action			#if kLogMethods			Log("WindowEditor.MenuHandler.EditSelectAll")			#endif						if GUIObj1.EditStatus = GUIObj1.kEditStatus_Default then return false						NoteMgr.SelectAll			GUIObj1.Draw						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditSelectNone() As Boolean Handles EditSelectNone.Action			#if kLogMethods			Log("WindowEditor.MenuHandler.EditSelectNone")			#endif						if GUIObj1.EditStatus = GUIObj1.kEditStatus_Default then return false						NoteMgr.SelectNone			GUIObj1.Draw						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function EditUndo() As Boolean Handles EditUndo.Action			CommandMgr.Undo						Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileClose() As Boolean Handles FileClose.Action			dim CloseMe as Boolean = WindowMgr.EditorClose(me)		End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileExportasMIDI() As Boolean Handles FileExportasMIDI.Action						self.FileMgr.ExportToMIDI						Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function MusicChangeKey() As Boolean Handles MusicChangeKey.Action			WindowChangeKey.ParentWindow = me			WindowChangeKey.Show			WindowChangeKey.GetKey(SongMgr.Keys(0))			GUIObj1.Draw			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function MusicLoopEntireSong() As Boolean Handles MusicLoopEntireSong.Action			PlayMgr.LoopEntireSong						Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function MusicSetStopCursorToEnd() As Boolean Handles MusicSetStopCursorToEnd.Action			PlayMgr.SetStopCursorToEnd						Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function NewTrack() As Boolean Handles NewTrack.Action			TrackListObj1.AddTrack						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function NotesAlterChord() As Boolean Handles NotesAlterChord.Action			EditMgr.MakeAlterChord						GUIObj1.Draw						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function NotesBreakChord() As Boolean Handles NotesBreakChord.Action			EditMgr.BreakChord			GUIObj1.Draw			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function NotesEditNotes() As Boolean Handles NotesEditNotes.Action			WindowEditNote.ParentWindow = me						WindowEditNote.Show						WindowEditNote.SetControls						GUIObj1.Draw			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function NotesGroup() As Boolean Handles NotesGroup.Action			EditMgr.MakeGroup						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function NotesLockUnlock() As Boolean Handles NotesLockUnlock.Action			EditMgr.LockUnlock			GUIObj1.Draw						Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function NotesMakeChord() As Boolean Handles NotesMakeChord.Action			EditMgr.MakeAlterChord						GUIObj1.Draw						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function NotesRemoveChord() As Boolean Handles NotesRemoveChord.Action			EditMgr.RemoveChord			GUIObj1.Draw			return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function NotesUngroup() As Boolean Handles NotesUngroup.Action			EditMgr.RemoveGroup						return true		End Function	#tag EndMenuHandler	#tag MenuHandler		Function SaveSave() As Boolean Handles SaveSave.Action			self.FileMgr.Save						Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function SaveSaveAs() As Boolean Handles SaveSaveAs.Action			self.FileMgr.Save						Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function TestChords() As Boolean Handles TestChords.Action			TestSuite.CreateTestChords						Return True		End Function	#tag EndMenuHandler	#tag MenuHandler		Function TestCreateBasicRandomMelody() As Boolean Handles TestCreateBasicRandomMelody.Action						ACS.MakeBasicRandomMelody						Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function TestCreateSequencerSound() As Boolean Handles TestCreateSequencerSound.Action						ACS.CreateSequencerSound						Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function TestNestedGroupsSample() As Boolean Handles TestNestedGroupsSample.Action			TestSuite.CreateOdeToJoy			TestSuite.CreateNestedGroups						Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function TestOdeToJoySample() As Boolean Handles TestOdeToJoySample.Action			TestSuite.CreateOdeToJoy						Return True					End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub ChangeScrollX(DeltaValue as integer)		  //me.Value is based on the number of measures in the song or the rightBoundNote		  self.GUIObj1.scrollDeltaX = DeltaValue		  ResizeBars		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ChangeScrollY(DeltaValue as integer)		  //me.Value is based on the number of total MIDI Notes: 0-127		  self.GUIObj1.scrollDeltaY = DeltaValue		  ResizeBars		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ChangeSnapTo(TheListIndex as integer)		  Select Case TheListIndex		  Case 0 '"Whole"		    GUIObj1.SnapTo = MIDILib.kNoteLength_01		  Case 1 '"1/2"		    GUIObj1.SnapTo = MIDILib.kNoteLength_02		  Case 2 '"1/4"		    GUIObj1.SnapTo = MIDILib.kNoteLength_04		  Case 3 '"1/8"		    GUIObj1.SnapTo = MIDILib.kNoteLength_08		  Case 4 '"1/16"		    GUIObj1.SnapTo = MIDILib.kNoteLength_16		  Case 5 '"1/32"		    GUIObj1.SnapTo = MIDILib.kNoteLength_32		  Case 6 '"1/64"		    GUIObj1.SnapTo = MIDILib.kNoteLength_64		  End Select		  		  if App.Opening = false then		    GUIObj1.Draw		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ChangeZoomX(NewValue as integer)		  self.GUIObj1.ResolutionX = NewValue		  ResizeBars		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ChangeZoomY(NewValue as integer)		  self.GUIObj1.ResolutionY = NewValue		  self.GUIObj1.PrepNoteInKeyIndicators		  ResizeBars		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub DecreaseTempo()		  SongMgr.Tempo = SongMgr.Tempo - 1		  		  if SongMgr.Tempo < MusicLib.kMinTempo then SongMgr.Tempo =  MusicLib.kMinTempo		  		  self.Tempo_EF.Text = str(SongMgr.Tempo)		  		  self.Refresh		  		  self.WindowNeedsSaving = true		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub IncreaseTempo()		  SongMgr.Tempo = SongMgr.Tempo + 1		  		  if SongMgr.Tempo > MusicLib.kMaxTempo then SongMgr.Tempo = MusicLib.kMaxTempo		  		  self.Tempo_EF.Text = str(SongMgr.Tempo)		  		  self.Refresh		  		  self.WindowNeedsSaving = true		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub Log(theText as string)		  WindowLog.Log(theText)		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub Open_IfAppOpening()		  if App.Opening then		    //add to the window array		    WindowMgr.Editors.Append me		    me.Name = "Untitled " + Str(Ubound(WindowMgr.Editors) + 1)		    me.Title = App.kAppName + " : " + me.Name		    		    //add the menu item		    dim EditorMenuItem as EditorMenuItemObj = new EditorMenuItemObj(me)		    EditorMenuItem.Text = me.Name		    EditorMenuItem.Tag = me		    MenuBar1.Child("EditorMenu").Append(EditorMenuItem)		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub Open_InitializeControlLinks()		  TrackListObj1.ParentWindow = me		  GUIObj1.ParentWindow = me		  		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub Open_InitializeGUIObjParameters()		  //set up the remaining default GUI Parameters		  GUIObj1.ResolutionX = SliderZoomX.Value		  GUIObj1.ResolutionY = SliderZoomY.Value		  GUIObj1.EditStatus = GUIObj.kEditStatus_Default		  'GUIObj1.SnapTo = MIDILib.kNoteLength_08		  GUIObj1.PrepNoteInKeyIndicators		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub Open_InitializeMgrs()		  //setting the core objects for all functionality		  if SongMgr = nil then SongMgr = new SongMgrObj		  if NoteMgr = nil then NoteMgr = new NoteMgrObj		  if EditMgr = nil then EditMgr = new EditMgrObj		  if PlayMgr = nil then PlayMgr = new PlayMgrObj		  if ACS = nil then ACS = new ACSObj		  if FileMgr = nil then FileMgr = new FileMgrObj		  if CommandMgr = nil then CommandMgr = new CommandMgrObj		  		  if TestSuite = nil then TestSuite = new TestSuiteObj		  		  SongMgr.ParentWindow = me		  NoteMgr.ParentWindow = me		  PlayMgr.ParentWindow = me		  EditMgr.ParentWindow = me		  ACS.ParentWindow = me		  FileMgr.ParentWindow = me		  TestSuite.ParentWindow = me		  CommandMgr.ParentWindow = me		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub Open_InitializeScrollBars()		  //set the scrollbar parameters		  xScrollBar.PageStep = SongMgr.TimeSignatureBeatsPerMeasure * SongMgr.TimeSignatureBasicBeat		  xScrollBar.LineStep = SongMgr.TimeSignatureBasicBeat		  xScrollBar.Maximum = self.SongMgr.TimeSignatureBasicBeat * self.SongMgr.TimeSignatureBeatsPerMeasure		  xScrollBar.Value = 0		  		  yScrollBar.Value = 47		  		  'yScrollBar.PageStep = 12 //a chromatic octave		  'yScrollBar.LineStep = 1		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub Open_InitializeSongMgr()		  if FileLib.NativeFile = nil then		    		    //these were in constructors until the FileOpen command changed all of that.		    		    '//We have to have at leat one key in the song. This is C Major		    'dim NewKey as KeyObj = new KeyObj		    'NewKey.Song = SongMgr		    'NewKey.Tonic = 0		    'NewKey.Key = MusicLib.kKeyMajor		    'NewKey.CalculatePitches		    '		    'SongMgr.Keys.Append NewKey		    '		    '//set up the remaining default parameters for the song		    'SongMgr.CreateColors		    'SongMgr.Tempo = 120		    'SongMgr.TimeSignatureBeatsPerMeasure = 4		    'SongMgr.TimeSignatureBasicBeat = MIDILib.kNoteLength_04		    'SongMgr.TotalBeats = SongMgr.TimeSignatureBeatsPerMeasure * SongMgr.TimeSignatureBasicBeat * 16 //the last multiplier being the number of measures.		    '		    'Tempo_EF.Text = Str(SongMgr.Tempo)		    		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub Open_Initialize_PM_BasicBeat()		  PM_BasicBeat.AddRow("1/2")		  PM_BasicBeat.AddRow("1/4")		  		  PM_BasicBeat.ListIndex = PM_BasicBeat.ListCount		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub Open_Initialize_PM_BeatsPerMeasure()		  PM_BeatsPerMeasure.AddRow("2")		  PM_BeatsPerMeasure.AddRow("3")		  PM_BeatsPerMeasure.AddRow("4")		  		  PM_BeatsPerMeasure.ListIndex = PM_BeatsPerMeasure.ListCount		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub Open_Initialize_PM_NewNoteLength()		  PM_NewNoteLength.AddRow("Whole")		  PM_NewNoteLength.AddRow("1/2")		  PM_NewNoteLength.AddRow("1/4")		  PM_NewNoteLength.AddRow("1/8")		  PM_NewNoteLength.AddRow("1/16")		  PM_NewNoteLength.AddRow("1/32")		  PM_NewNoteLength.AddRow("1/64")		  		  PM_NewNoteLength.ListIndex = 2		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Sub Open_Initialize_PM_SnapTo()		  PM_SnapTo.AddRow("Whole")		  PM_SnapTo.AddRow("1/2")		  PM_SnapTo.AddRow("1/4")		  PM_SnapTo.AddRow("1/8")		  PM_SnapTo.AddRow("1/16")		  PM_SnapTo.AddRow("1/32")		  PM_SnapTo.AddRow("1/64")		  		  PM_SnapTo.ListIndex = 3		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ResizeBars()		  dim editorWidthInBeats as integer		  		  editorWidthInBeats = (self.GUIObj1.Width - self.GUIObj1.kKeyPicWidth) \ self.GUIObj1.ResolutionX		  		  SongMgr.TotalBeats = NoteMgr.GetTotalBeats		  		  'xScrollBar.Maximum = Max(SongMgr.TotalBeats, (self.SongMgr.TimeSignatureBasicBeat * self.SongMgr.TimeSignatureBeatsPerMeasure)) '- editorWidthInBeats		  xScrollBar.Maximum = Max(SongMgr.TotalBeats, self.PlayMgr.StopCursor.StartBeat)		  		  GUIObj1.scrollDeltaX = xScrollBar.Value		  		  dim editorHeightInKeys as integer		  		  editorHeightinKeys = (self.GUIObj1.Height - self.GUIObj1.kRulerPicHeight) \ self.GUIObj1.ResolutionY		  		  yScrollBar.Maximum = MIDILib.kMIDINoteCount - editorHeightinKeys + 1 //+1 reslves a bug where the editor wouldn't show note 0		  		  if (self.GUIObj1.Height - self.GUIObj1.kRulerPicHeight) > MIDILib.kMIDINoteCount * self.GUIObj1.ResolutionY then		    GUIObj1.scrollDeltaY = 0		  else		    GUIObj1.scrollDeltaY = yScrollBar.Value		  end if		  		  GUIObj1.Draw		  		  EditorTop = GUIObj1.Top		  EditorLeft = GUIObj1.Left		  editorWidth = GUIObj1.Width		  EditorHeight = GUIObj1.Height		  		  TrackListTop = TrackListObj1.Top		  TrackListLeft = TrackListObj1.Left		  TrackListWidth = TrackListObj1.Width		  TrackListHeight = TrackListObj1.Height		End Sub	#tag EndMethod	#tag Method, Flags = &h21		Private Function SelectionHasGroup() As Boolean		  dim thisObject as integer = 0		  dim firstObject as integer = 0		  dim lastObject as integer = UBound(NoteMgr.Selection)		  		  if lastObject = -1 then return false		  		  for thisObject = firstObject to lastObject		    if NoteMgr.Selection(thisObject) <> nil then		      if NoteMgr.Selection(thisObject) IsA GroupObj then return true		    end if		  next		  		  return false		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub SetEditMode(Mode as integer)		  #if kLogMethods		    Log("WindowEditor.SetEditMode(" + Str(Mode) + ")")		  #endif		  		  Select Case Mode		  Case GUIObj1.kEditStatus_Add //ADD		    BButtonNoteEdit.Value = false		    BButtonNoteDelete.Value = false		    if BButtonNoteAdd.Value = true then		      GUIObj1.EditStatus = GUIObj1.kEditStatus_Add		    else		      GUIObj1.EditStatus = GUIObj1.kEditStatus_Default		    end if		  Case GUIObj1.kEditStatus_Edit //EDIT		    BButtonNoteAdd.Value = false		    BButtonNoteDelete.Value = false		    if BButtonNoteEdit.Value = true then		      GUIObj1.EditStatus = GUIObj1.kEditStatus_Edit		    else		      GUIObj1.EditStatus = GUIObj1.kEditStatus_Default		    end if		  Case GUIObj1.kEditStatus_Delete //DELETE		    BButtonNoteAdd.Value = false		    BButtonNoteEdit.Value = false		    if BButtonNoteDelete.Value = true then		      GUIObj1.EditStatus = GUIObj1.kEditStatus_Delete		    else		      GUIObj1.EditStatus = GUIObj1.kEditStatus_Default		    end if		  End Select		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetWindowModified(TheWindow As Window, IsModified as Boolean)		  Dim osErr As Integer		  Dim v As Variant		  		  #if TargetMacOS then		    #if TargetCarbon then		      Declare Function SetWindowModified Lib "Carbon" (window As WindowPtr, modified As Integer) As Integer		    #else		      Declare Function SetWindowModified Lib "WindowsLib" (window As WindowPtr, modified As Integer) As Integer		    #endif // TargetCarbon		    v = IsModified		    osErr = SetWindowModified(TheWindow, v)		  #endif // TargetMacOS		End Sub	#tag EndMethod	#tag Property, Flags = &h0		ACS As ACSObj	#tag EndProperty	#tag Property, Flags = &h0		CommandMgr As CommandMgrObj	#tag EndProperty	#tag Property, Flags = &h0		EditMgr As EditMgrObj	#tag EndProperty	#tag Property, Flags = &h21		Private EditorHeight As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private EditorLeft As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private EditorTop As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private EditorWidth As Integer	#tag EndProperty	#tag Property, Flags = &h0		FileMgr As FileMgrObj	#tag EndProperty	#tag Property, Flags = &h21		Private mWindowNeedsSaving As Boolean	#tag EndProperty	#tag Property, Flags = &h0		Name As String	#tag EndProperty	#tag Property, Flags = &h0		NoteMgr As NoteMgrObj	#tag EndProperty	#tag Property, Flags = &h0		PlayMgr As PlayMgrObj	#tag EndProperty	#tag Property, Flags = &h0		SongMgr As SongMgrObj	#tag EndProperty	#tag Property, Flags = &h0		TestSuite As TestSuiteObj	#tag EndProperty	#tag Property, Flags = &h21		Private TrackListHeight As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private TrackListLeft As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private TrackListTop As Integer	#tag EndProperty	#tag Property, Flags = &h21		Private TrackListWidth As Integer	#tag EndProperty	#tag Property, Flags = &h0		WindowHasFileToOpen As Boolean = False	#tag EndProperty	#tag ComputedProperty, Flags = &h0		#tag Getter			Get			  return mWindowNeedsSaving			End Get		#tag EndGetter		#tag Setter			Set			  mWindowNeedsSaving = value			  			  SetWindowModified(self, mWindowNeedsSaving)			End Set		#tag EndSetter		WindowNeedsSaving As Boolean	#tag EndComputedProperty#tag EndWindowCode#tag Events TrackListObj1	#tag Event		Function HeaderPressed(column as Integer) As Boolean		  //this keeps the user from sorting the listbox		  return true		End Function	#tag EndEvent#tag EndEvents#tag Events yScrollBar	#tag Event		Sub ValueChanged()		  ChangeScrollY(me.Value)		End Sub	#tag EndEvent#tag EndEvents#tag Events xScrollBar	#tag Event		Sub ValueChanged()		  ChangeScrollX(me.Value)		End Sub	#tag EndEvent#tag EndEvents#tag Events BButtonNoteAdd	#tag Event		Sub Action()		  #if kLogEvents		    Log("WindowEditor.BButtonNoteAdd")		  #endif		  		  SetEditMode(GUIObj1.kEditStatus_Add)		End Sub	#tag EndEvent#tag EndEvents#tag Events BButtonNoteDelete	#tag Event		Sub Action()		  #if kLogEvents		    Log("WindowEditor.BButtonNoteDelete")		  #endif		  		  SetEditMode(GUIObj1.kEditStatus_Delete)		End Sub	#tag EndEvent#tag EndEvents#tag Events BButtonNoteEdit	#tag Event		Sub Action()		  #if kLogEvents		    Log("WindowEditor.BButtonNoteEdit")		  #endif		  		  SetEditMode(GUIObj1.kEditStatus_Edit)		End Sub	#tag EndEvent#tag EndEvents#tag Events BButtonNoteLock	#tag Event		Sub Action()		  EditMgr.LockUnlock		  GUIObj1.Draw		End Sub	#tag EndEvent#tag EndEvents#tag Events BButtonTrackAdd	#tag Event		Sub Action()		  #if kLogEvents		    WindowLog.Log("WindowEditor")		  #endif		  		  self.TrackListObj1.AddTrack		End Sub	#tag EndEvent#tag EndEvents#tag Events BButtonTrackDelete	#tag Event		Sub Action()		  		  		  self.TrackListObj1.DeleteTrack		End Sub	#tag EndEvent#tag EndEvents#tag Events SliderZoomX	#tag Event		Sub ValueChanged()		  ChangeZoomX(me.Value)		End Sub	#tag EndEvent#tag EndEvents#tag Events SliderZoomY	#tag Event		Sub ValueChanged()		  ChangeZoomY(me.Value)		End Sub	#tag EndEvent#tag EndEvents#tag Events PM_NewNoteLength	#tag Event		Sub Change()		  Select Case me.ListIndex		  Case 0 '"Whole"		    NoteMgr.NewNoteLength = MIDILib.kNoteLength_01		  Case 1 '"1/2"		    NoteMgr.NewNoteLength = MIDILib.kNoteLength_02		  Case 2 '"1/4"		    NoteMgr.NewNoteLength = MIDILib.kNoteLength_04		  Case 3 '"1/8"		    NoteMgr.NewNoteLength = MIDILib.kNoteLength_08		  Case 4 '"1/16"		    NoteMgr.NewNoteLength = MIDILib.kNoteLength_16		  Case 5 '"1/32"		    NoteMgr.NewNoteLength = MIDILib.kNoteLength_32		  Case 6 '"1/64"		    NoteMgr.NewNoteLength = MIDILib.kNoteLength_64		  End Select		  		  if App.Opening = false then		    GUIObj1.Draw		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events PM_SnapTo	#tag Event		Sub Change()		  ChangeSnapTo(me.ListIndex)		End Sub	#tag EndEvent#tag EndEvents#tag Events PM_BeatsPerMeasure	#tag Event		Sub Change()		  		  		  //Any changes to this need to be made to self.FileMgr.MIDI_CreateTrack		  		  Select Case me.ListIndex		  Case 0 '2		    SongMgr.TimeSignatureBeatsPerMeasure = 2		  Case 1 '3		    SongMgr.TimeSignatureBeatsPerMeasure = 3		  Case 2 '4		    SongMgr.TimeSignatureBeatsPerMeasure = 4		  End Select		  		  if App.Opening = false then		    self.WindowNeedsSaving = true		    GUIObj1.Draw		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events PM_BasicBeat	#tag Event		Sub Change()		  		  		  //Any changes to this need to be made to self.FileMgr.MIDI_CreateTrack		  		  Select Case me.ListIndex		  Case 0 '2		    SongMgr.TimeSignatureBasicBeat = MIDILib.kNoteLength_02		    'Case 1 '3		    'SongMgr.TimeSignatureBasicBeat = MIDILib.kNoteLength_0 //There are no 1/3 note values in MIDI		  Case 1 '4		    SongMgr.TimeSignatureBasicBeat = MIDILib.kNoteLength_04		  End Select		  		  if App.Opening = false then		    self.WindowNeedsSaving = true		    GUIObj1.Draw		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events Play_PB	#tag Event		Sub Action()		  if Ubound(self.NoteMgr.Notes) = -1 then return		  		  if me.Default = true then		    me.Default = false		    me.Caption = "Stop"		    PlayMgr.Play		  else		    me.Default = true		    me.Caption = "Play"		    PlayMgr.StopFlag = true		    PlayMgr.Stop		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events Tempo_UDA	#tag Event		Sub Up()		  IncreaseTempo		End Sub	#tag EndEvent	#tag Event		Sub Down()		  DecreaseTempo		End Sub	#tag EndEvent#tag EndEvents#tag Events BButtonTrackDupe	#tag Event		Sub Action()		  		  		  self.TrackListObj1.DuplicateTrack		End Sub	#tag EndEvent#tag EndEvents#tag Events Loop_Check	#tag Event		Sub Action()		  if me.Value = true then		    PlayMgr.LoopPlay = true		  else		    PlayMgr.LoopPlay = false		  end if		  		  GUIObj1.Draw		End Sub	#tag EndEvent#tag EndEvents