#tag WindowBegin Window WindowMakeChord   BackColor       =   16777215   Backdrop        =   ""   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   False   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   498   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   500   MaximizeButton  =   False   MaxWidth        =   400   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   300   MinimizeButton  =   True   MinWidth        =   400   Placement       =   0   Resizeable      =   False   Title           =   "Make Chord"   Visible         =   True   Width           =   500   Begin GroupBox ChordModifiers_GB      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Chord Modifiers"      Enabled         =   True      Height          =   55      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   225      Underline       =   ""      Visible         =   True      Width           =   460      Begin RadioButton ChordModifierPower_RB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Power"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordModifiers_GB"         Italic          =   ""         Left            =   140         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   251         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   128      End      Begin RadioButton ChordModifierSuspended_RB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Suspended"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordModifiers_GB"         Italic          =   ""         Left            =   280         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   251         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   192      End      Begin RadioButton ChordModifierNone_RB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "None"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordModifiers_GB"         Italic          =   ""         Left            =   28         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   251         Underline       =   ""         Value           =   True         Visible         =   True         Width           =   100      End   End   Begin PushButton Cancel_PB      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "Cancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   308      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   458      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin GroupBox ChordExtension_GB      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Chord Extensions"      Enabled         =   True      Height          =   167      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   46      Underline       =   ""      Visible         =   True      Width           =   460      Begin PopupMenu ChordExtensionSeventhType_PM         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordExtension_GB"         InitialValue    =   ""         Italic          =   ""         Left            =   244         ListIndex       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   71         Underline       =   ""         Visible         =   True         Width           =   144      End      Begin RadioButton ChordExtensionNone_RB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "None"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordExtension_GB"         Italic          =   ""         Left            =   28         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   72         Underline       =   ""         Value           =   True         Visible         =   True         Width           =   100      End      Begin PopupMenu ChordExtensionEleventhType_PM         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordExtension_GB"         InitialValue    =   ""         Italic          =   ""         Left            =   244         ListIndex       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   135         Underline       =   ""         Visible         =   True         Width           =   144      End      Begin PopupMenu ChordExtensionNinthType_PM         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordExtension_GB"         InitialValue    =   ""         Italic          =   ""         Left            =   244         ListIndex       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   6         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   104         Underline       =   ""         Visible         =   True         Width           =   144      End      Begin CheckBox ChordExtensionSeventh_CB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Seventh"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordExtension_GB"         Italic          =   ""         Left            =   140         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   7         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   72         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   100      End      Begin CheckBox ChordExtensionNinth_CB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Ninth"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordExtension_GB"         Italic          =   ""         Left            =   140         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   8         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   104         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   100      End      Begin CheckBox ChordExtensionEleventh_CB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Eleventh"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordExtension_GB"         Italic          =   ""         Left            =   140         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   9         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   136         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   100      End      Begin Separator Separator1         AutoDeactivate  =   True         Enabled         =   True         Height          =   3         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordExtension_GB"         Left            =   132         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   7         TabPanelIndex   =   0         TabStop         =   True         Top             =   168         Visible         =   True         Width           =   340      End      Begin CheckBox ChordExtensionSixth_CB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Sixth"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordExtension_GB"         Italic          =   ""         Left            =   140         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   9         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   184         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   100      End      Begin PopupMenu ChordExtensionSixthType_PM         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordExtension_GB"         InitialValue    =   ""         Italic          =   ""         Left            =   244         ListIndex       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   9         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   183         Underline       =   ""         Visible         =   True         Width           =   144      End   End   Begin PushButton OK_PB      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "OK"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   400      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   458      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PopupMenu ChordType_PM      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   140      ListIndex       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   13      Underline       =   ""      Visible         =   True      Width           =   248   End   Begin Label ST_ChordType      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   28      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Chord Type"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      Top             =   14      Underline       =   ""      Visible         =   True      Width           =   100   End   Begin GroupBox ChordInversions_GB      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Inversions"      Enabled         =   True      Height          =   55      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   391      Underline       =   ""      Visible         =   False      Width           =   460      Begin RadioButton ChordModifierSecondInv_RB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Second Inversion"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordInversions_GB"         Italic          =   ""         Left            =   280         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   417         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   192      End      Begin RadioButton ChordModifierFirstInv_RB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "First Inversion"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordInversions_GB"         Italic          =   ""         Left            =   140         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   417         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   128      End      Begin RadioButton ChordInversionsNone_RB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "None"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ChordInversions_GB"         Italic          =   ""         Left            =   28         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   417         Underline       =   ""         Value           =   True         Visible         =   True         Width           =   100      End   End   Begin GroupBox Arpeggiate_GB      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Arpeggiate"      Enabled         =   True      Height          =   87      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   292      Underline       =   ""      Visible         =   True      Width           =   460      Begin RadioButton ChordArpeggiateNone_RB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "None"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "Arpeggiate_GB"         Italic          =   ""         Left            =   28         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   317         Underline       =   ""         Value           =   True         Visible         =   True         Width           =   100      End      Begin RadioButton ChordArpeggiateLowToHigh_RB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Low to High"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "Arpeggiate_GB"         Italic          =   ""         Left            =   140         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   317         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   100      End      Begin RadioButton ChordArpeggiateHighToLow_RB         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "High to Low"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "Arpeggiate_GB"         Italic          =   ""         Left            =   280         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   317         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   100      End      Begin PopupMenu ChordArpeggiateLength_PM         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "Arpeggiate_GB"         InitialValue    =   ""         Italic          =   ""         Left            =   238         ListIndex       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         Top             =   349         Underline       =   ""         Visible         =   True         Width           =   150      End      Begin Label ChordArpeggiateLength_ST         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "Arpeggiate_GB"         Italic          =   ""         Left            =   140         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Length"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         Top             =   350         Underline       =   ""         Visible         =   True         Width           =   92      End   EndEnd#tag EndWindow#tag WindowCode	#tag Method, Flags = &h0		Sub GetChord(Chord as ChordObj)		  dim Settings as integer = Chord.Settings		  		  //get the chord type		  GetChordType(Settings)		  		  //get the extensions		  GetChordExtensionSixth(Settings)		  GetChordExtensionSeventh(Settings)		  GetChordExtensionNinth(Settings)		  GetChordExtensionEleventh(Settings)		  		  //get the modifiers		  GetChordModifers(Settings)		  		  //get the arpeggiation		  GetChordArpeggio(Settings)		  		  //get the inversion		  //TO COME because Inversions are CRAZY!		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub GetChordArpeggio(Settings as Integer)		  If GetFlag(DataLib.kFlagChordArpeggiate_LowToHigh, Settings) or GetFlag(DataLib.kFlagChordArpeggiate_HighToLow, Settings) then		    		    If GetFlag(DataLib.kFlagChordArpeggiate_LowToHigh, Settings) then		      self.ChordArpeggiateLowToHigh_RB.Value = true		    End If		    		    If GetFlag(DataLib.kFlagChordArpeggiate_HighToLow, Settings) then		      self.ChordArpeggiateHighToLow_RB.Value = true		    End If		    		    dim ArpeggioLengthMask as integer = GetChordArpeggioLengthMask(Settings)		    SetChordArpeggioLengthPMListIndex(ArpeggioLengthMask)		    		  End If		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function GetChordArpeggioLengthMask(Settings as Integer) As Integer		  dim ArpeggioLengthMask as integer = 0		  		  if DataLib.GetFlag(DataLib.kFlagChordArpeggiate_Length_01, settings) then ArpeggioLengthMask = ArpeggioLengthMask + DataLib.kFlagChordArpeggiate_Length_01		  if DataLib.GetFlag(DataLib.kFlagChordArpeggiate_Length_02, settings) then ArpeggioLengthMask = ArpeggioLengthMask + DataLib.kFlagChordArpeggiate_Length_02		  if DataLib.GetFlag(DataLib.kFlagChordArpeggiate_Length_04, settings) then ArpeggioLengthMask = ArpeggioLengthMask + DataLib.kFlagChordArpeggiate_Length_04		  if DataLib.GetFlag(DataLib.kFlagChordArpeggiate_Length_08, settings) then ArpeggioLengthMask = ArpeggioLengthMask + DataLib.kFlagChordArpeggiate_Length_08		  if DataLib.GetFlag(DataLib.kFlagChordArpeggiate_Length_16, settings) then ArpeggioLengthMask = ArpeggioLengthMask + DataLib.kFlagChordArpeggiate_Length_16		  if DataLib.GetFlag(DataLib.kFlagChordArpeggiate_Length_32, settings) then ArpeggioLengthMask = ArpeggioLengthMask + DataLib.kFlagChordArpeggiate_Length_32		  if DataLib.GetFlag(DataLib.kFlagChordArpeggiate_Length_64, settings) then ArpeggioLengthMask = ArpeggioLengthMask + DataLib.kFlagChordArpeggiate_Length_64		  		  return ArpeggioLengthMask		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub GetChordExtensionEleventh(Settings as Integer)		  if DataLib.GetFlag(DataLib.kFlagChordExtension_Eleventh_Major, Settings) OR DataLib.GetFlag(DataLib.kFlagChordExtension_Eleventh_Minor, Settings) then		    self.ChordExtensionEleventh_CB.Value = true		    if DataLib.GetFlag(DataLib.kFlagChordExtension_Eleventh_Major, Settings) then		      self.ChordExtensionEleventhType_PM.ListIndex = 0		    elseif DataLib.GetFlag(DataLib.kFlagChordExtension_Eleventh_Minor, Settings) then		      self.ChordExtensionEleventhType_PM.ListIndex = 1		    end if		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub GetChordExtensionNinth(Settings as Integer)		  if DataLib.GetFlag(DataLib.kFlagChordExtension_Ninth_Major, Settings) OR DataLib.GetFlag(DataLib.kFlagChordExtension_Ninth_Major, Settings) then		    self.ChordExtensionNinth_CB.Value = true		    if DataLib.GetFlag(DataLib.kFlagChordExtension_Ninth_Major, Settings) then		      self.ChordExtensionNinthType_PM.ListIndex = 0		    elseif DataLib.GetFlag(DataLib.kFlagChordExtension_Ninth_Minor, Settings) then		      self.ChordExtensionNinthType_PM.ListIndex = 1		    end if		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub GetChordExtensionSeventh(Settings as Integer)		  if DataLib.GetFlag(DataLib.kFlagChordExtension_Seventh_Major, Settings) OR DataLib.GetFlag(DataLib.kFlagChordExtension_Seventh_Minor, Settings) then		    self.ChordExtensionSeventh_CB.Value = true		    if DataLib.GetFlag(DataLib.kFlagChordExtension_Seventh_Major, Settings) then		      self.ChordExtensionSeventhType_PM.ListIndex = 0		    elseif DataLib.GetFlag(DataLib.kFlagChordExtension_Seventh_Minor, Settings) then		      self.ChordExtensionSeventhType_PM.ListIndex = 1		    end if		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub GetChordExtensionSixth(Settings as integer)		  if DataLib.GetFlag(DataLib.kFlagChordExtension_Sixth_Major, Settings) OR DataLib.GetFlag(DataLib.kFlagChordExtension_Sixth_Minor, Settings) then		    self.ChordExtensionSixth_CB.Value = true		    if DataLib.GetFlag(DataLib.kFlagChordExtension_Sixth_Major, Settings) then		      self.ChordExtensionSixthType_PM.ListIndex = 0		    elseif DataLib.GetFlag(DataLib.kFlagChordExtension_Sixth_Major, Settings) then		      self.ChordExtensionSixthType_PM.ListIndex = 1		    end if		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub GetChordModifers(Settings as Integer)		  If GetFlag(DataLib.kFlagChordModifier_Power, Settings) then		    self.ChordModifierPower_RB.Value = true		  End If		  		  If GetFlag(DataLib.kFlagChordModifier_Suspended, Settings) then		    self.ChordModifierSuspended_RB.Value = true		  End If		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub GetChordType(Settings as Integer)		  if DataLib.GetFlag(DataLib.kFlagChordType_Major, Settings) then 		    self.ChordType_PM.ListIndex = 0		  end if		  		  if DataLib.GetFlag(DataLib.kFlagChordType_Minor, Settings) then 		    self.ChordType_PM.ListIndex = 1		  end if		  		  if DataLib.GetFlag(DataLib.kFlagChordType_Diminished, Settings) then 		    self.ChordType_PM.ListIndex = 2		  end if		  		  if DataLib.GetFlag(DataLib.kFlagChordType_Augmented, Settings) then 		    self.ChordType_PM.ListIndex = 3		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub MakeChord()		  dim settings as integer		  dim Selection as integer		  		  settings = &h00000000 //this is probably unecessary		  		  //let's get the basic chord		  Selection = self.ChordType_PM.ListIndex		  		  select case Selection		  case 0 //"Major")		    settings = DataLib.SetFlag(DataLib.kFlagChordType_Major, settings)		  case 1 //"Minor")		    settings = DataLib.SetFlag(DataLib.kFlagChordType_Minor, settings)		  case 2 //"Diminished")		    settings = DataLib.SetFlag(DataLib.kFlagChordType_Diminished, settings)		  case 3 //"Augmented")		    settings = DataLib.SetFlag(DataLib.kFlagChordType_Augmented, settings)		  end select		  		  //Let's add the chord extensions if there are any		  if self.ChordExtensionNone_RB.Value = false then		    		    //Sixth		    if self.ChordExtensionSixth_CB.Value = true then		      Selection = self.ChordExtensionSixthType_PM.ListIndex		      select case Selection		      Case 0		        settings = DataLib.SetFlag(DataLib.kFlagChordExtension_Sixth_Major, settings)		      case 1		        settings = DataLib.SetFlag(DataLib.kFlagChordExtension_Sixth_Minor, settings)		      end select		    end if		    		    //Seventh		    if self.ChordExtensionSeventh_CB.Value = true then		      Selection = self.ChordExtensionSeventhType_PM.ListIndex		      select case Selection		      Case 0		        settings = DataLib.SetFlag(DataLib.kFlagChordExtension_Seventh_Major, settings)		      case 1		        settings = DataLib.SetFlag(DataLib.kFlagChordExtension_Seventh_Minor, settings)		      end select		    end if		    		    //Ninth		    if self.ChordExtensionNinth_CB.Value = true then		      Selection = self.ChordExtensionNinthType_PM.ListIndex		      select case Selection		      Case 0		        settings = DataLib.SetFlag(DataLib.kFlagChordExtension_Ninth_Major, settings)		      case 1		        settings = DataLib.SetFlag(DataLib.kFlagChordExtension_Ninth_Minor, settings)		      end select		    end if		    		    //Eleventh		    if self.ChordExtensionEleventh_CB.Value = true then		      Selection = self.ChordExtensionEleventhType_PM.ListIndex		      select case Selection		      Case 0		        settings = DataLib.SetFlag(DataLib.kFlagChordExtension_Eleventh_Major, settings)		      case 1		        settings = DataLib.SetFlag(DataLib.kFlagChordExtension_Eleventh_Minor, settings)		      end select		    end if		    		  end if		  		  //let's flag the modifiers now.		  		  //inversions are crazy and need to be handled alone without everything else getting in the way. 		  //If they selected an inversion, then the rest goes away.		  if self.ChordModifierFirstInv_RB.Value = true then settings = DataLib.SetFlag(DataLib.kFlagChordModifier_FirstInv, settings)		  if self.ChordModifierSecondInv_RB.Value = true then settings = DataLib.SetFlag(DataLib.kFlagChordModifier_SecondInv, settings)		  		  if self.ChordInversionsNone_RB.Value = true then		    		    if self.ChordModifierSuspended_RB.Enabled = true and self.ChordModifierSuspended_RB.Value = true then		      settings = DataLib.SetFlag(DataLib.kFlagChordModifier_Suspended, settings)		    end if		    		    if self.ChordModifierPower_RB.Value = true then settings = DataLib.SetFlag(DataLib.kFlagChordModifier_Power, settings)		    		    if self.ChordArpeggiateLowToHigh_RB.Value = true then settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_LowToHigh, settings)		    if self.ChordArpeggiateHighToLow_RB.Value = true then settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_HighToLow, settings)		    		    if self.ChordArpeggiateLowToHigh_RB.Value = true OR self.ChordArpeggiateHighToLow_RB.Value = true then		      Select Case self.ChordArpeggiateLength_PM.ListIndex		      Case 0 '("Whole")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_01, settings)		      Case 1 '("1/2")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_02, settings)		      Case 2 '("1/2 (Dotted)")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_02, settings)		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_04, settings)		      Case 3 '("1/4")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_04, settings)		      Case 4 '("1/4 (Dotted)")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_04, settings)		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_08, settings)		      Case 5 '("1/8")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_08, settings)		      Case 6 '("1/8 (Dotted)")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_08, settings)		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_16, settings)		      Case 7 '("1/16")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_16, settings)		      Case 8 '("1/16 (Dotted)")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_16, settings)		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_32, settings)		      Case 9 '("1/32")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_32, settings)		      Case 10 '("1/32 (Dotted)")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_32, settings)		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_64, settings)		      Case 11 '("1/64")		        settings = DataLib.SetFlag(DataLib.kFlagChordArpeggiate_Length_64, settings)		      End Select		    end if		    		  end if		  		  ParentWindow.EditMgr.MakeChord(Settings)		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub ResetChordExtensionControls()		  If self.ChordExtensionEleventh_CB.Value = False and _		    self.ChordExtensionNinth_CB.Value = False and _		    self.ChordExtensionSeventh_CB.Value = False and _		    self.ChordExtensionSixth_CB.Value = False then		    self.ChordExtensionNone_RB.Value = True		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub SetChordArpeggioLengthPMListIndex(ArpeggioLengthMask as integer)		  Select Case ArpeggioLengthMask		    		  Case DataLib.kFlagChordArpeggiate_Length_01		    self.ChordArpeggiateLength_PM.ListIndex = 0		    		  Case DataLib.kFlagChordArpeggiate_Length_02		    self.ChordArpeggiateLength_PM.ListIndex = 1		    		  Case DataLib.kFlagChordArpeggiate_Length_02 + DataLib.kFlagChordArpeggiate_Length_04		    self.ChordArpeggiateLength_PM.ListIndex = 2		    		  Case DataLib.kFlagChordArpeggiate_Length_04		    self.ChordArpeggiateLength_PM.ListIndex = 3		    		  Case DataLib.kFlagChordArpeggiate_Length_04 + DataLib.kFlagChordArpeggiate_Length_08		    self.ChordArpeggiateLength_PM.ListIndex = 4		    		  Case DataLib.kFlagChordArpeggiate_Length_08		    self.ChordArpeggiateLength_PM.ListIndex = 5		    		  Case DataLib.kFlagChordArpeggiate_Length_08 + DataLib.kFlagChordArpeggiate_Length_16		    self.ChordArpeggiateLength_PM.ListIndex = 6		    		  Case DataLib.kFlagChordArpeggiate_Length_16		    self.ChordArpeggiateLength_PM.ListIndex = 7		    		  Case DataLib.kFlagChordArpeggiate_Length_16 + DataLib.kFlagChordArpeggiate_Length_32		    self.ChordArpeggiateLength_PM.ListIndex = 8		    		  Case DataLib.kFlagChordArpeggiate_Length_32		    self.ChordArpeggiateLength_PM.ListIndex = 9		    		  Case DataLib.kFlagChordArpeggiate_Length_32 + DataLib.kFlagChordArpeggiate_Length_64		    self.ChordArpeggiateLength_PM.ListIndex = 10		    		  Case DataLib.kFlagChordArpeggiate_Length_64		    self.ChordArpeggiateLength_PM.ListIndex = 11		    		  else		    //do nothing		  End Select		End Sub	#tag EndMethod	#tag Note, Name = Features to add		[ ] Simple Harmonics (Intervals, Idiot's Guide, page 21)	#tag EndNote	#tag Note, Name = How this window works		The window doesn't care about the selection.				The user makes their settings (which will change appropriately).		They click OK		MakeChord then goes through the settings for the controls and sets the flags.		Once the flags are set, they get handed over to EditMgr.MakeChord, which cares about what's selected.		But it's the chord itself that does the calculations, so the settings get passed on to there as well.				The one thing that isn't discreet is the difference between making a new chord and altering a current one.	#tag EndNote	#tag Note, Name = Known Bugs		All new bug reports need to go to MusicSketchBugs.003				[FIXED] There's a strange timing issue where if I click "OK" too soon, then it gives a NilObjectException on a ListIndex	#tag EndNote	#tag Property, Flags = &h0		ParentWindow As WindowEditor	#tag EndProperty#tag EndWindowCode#tag Events Cancel_PB	#tag Event		Sub Action()		  self.Close		  ParentWindow.Show		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordExtensionSeventhType_PM	#tag Event		Sub Open()		  me.AddRow("Major")		  me.AddRow("Minor")		  		  me.ListIndex = 0		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordExtensionNone_RB	#tag Event		Sub Action()		  if me.Value = true then		    self.ChordExtensionEleventh_CB.Value = false		    self.ChordExtensionNinth_CB.Value = false		    self.ChordExtensionSeventh_CB.Value = false		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordExtensionEleventhType_PM	#tag Event		Sub Open()		  me.AddRow("Major")		  me.AddRow("Minor")		  'me.AddRow("Dominant")		  		  me.ListIndex = 0		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordExtensionNinthType_PM	#tag Event		Sub Open()		  me.AddRow("Major")		  me.AddRow("Minor")		  		  me.ListIndex = 0		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordExtensionSeventh_CB	#tag Event		Sub Action()		  if me.Value = true then		    self.ChordExtensionSeventhType_PM.Enabled = true		    		    self.ChordExtensionNone_RB.Value = false		    		  else		    self.ChordExtensionSeventhType_PM.Enabled = false		  end if		  		  ResetChordExtensionControls		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordExtensionNinth_CB	#tag Event		Sub Action()		  if me.Value = true then		    self.ChordExtensionNinthType_PM.Enabled = true		    		    self.ChordExtensionNone_RB.Value = false		    		    self.ChordExtensionSeventh_CB.Value = true		    		  else		    self.ChordExtensionNinthType_PM.Enabled = false		  end if		  		  ResetChordExtensionControls		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordExtensionEleventh_CB	#tag Event		Sub Action()		  if me.Value = true then		    self.ChordExtensionEleventhType_PM.Enabled = true		    		    self.ChordExtensionNone_RB.Value = false		    		    self.ChordExtensionNinth_CB.Value = true		    self.ChordExtensionSeventh_CB.Value = true		    		  else		    self.ChordExtensionEleventhType_PM.Enabled = false		  end if		  		  ResetChordExtensionControls		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordExtensionSixth_CB	#tag Event		Sub Action()		  if me.Value = true then		    		    self.ChordExtensionSixthType_PM.Enabled = true		    		    self.ChordExtensionNone_RB.Value = false		    		  else		    self.ChordExtensionSixthType_PM.Enabled = false		  end if		  		  ResetChordExtensionControls		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordExtensionSixthType_PM	#tag Event		Sub Open()		  me.AddRow("Major")		  me.AddRow("Minor")		  'me.AddRow("Dominant")		  		  me.ListIndex = 0		End Sub	#tag EndEvent#tag EndEvents#tag Events OK_PB	#tag Event		Sub Action()		  MakeChord //this has to come first so that we can get the index.		  self.Close		  ParentWindow.Show		  		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordType_PM	#tag Event		Sub Open()		  me.AddRow("Major")		  me.AddRow("Minor")		  me.AddRow("Diminished")		  me.AddRow("Augmented")		  		  me.ListIndex = 0		End Sub	#tag EndEvent	#tag Event		Sub Change()		  //Only Major and Augmented chords can be suspended because they rely on making a Perfect Third a Perfect Fourth		  if me.ListIndex = 0 or me.ListIndex = 3 then		    self.ChordModifierSuspended_RB.Enabled = true		  else		    self.ChordModifierSuspended_RB.Enabled = false		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordArpeggiateNone_RB	#tag Event		Sub Action()		  if me.Value = true then		    self.ChordArpeggiateLength_ST.Enabled = false		    self.ChordArpeggiateLength_PM.Enabled = false		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordArpeggiateLowToHigh_RB	#tag Event		Sub Action()		  if me.Value = true then		    self.ChordArpeggiateLength_ST.Enabled = true		    self.ChordArpeggiateLength_PM.Enabled = true		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordArpeggiateHighToLow_RB	#tag Event		Sub Action()		  if me.Value = true then		    self.ChordArpeggiateLength_ST.Enabled = true		    self.ChordArpeggiateLength_PM.Enabled = true		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events ChordArpeggiateLength_PM	#tag Event		Sub Open()		  me.AddRow("Whole") '0		  me.AddRow("1/2") '1		  me.AddRow("1/2 (Dotted)") '2		  me.AddRow("1/4") '3		  me.AddRow("1/4 (Dotted)") '4		  me.AddRow("1/8") '5		  me.AddRow("1/8 (Dotted)") '6		  me.AddRow("1/16") '7		  me.AddRow("1/16 (Dotted)") '8		  me.AddRow("1/32") '9		  me.AddRow("1/32 (Dotted)") '10		  me.AddRow("1/64") '11		  		  me.ListIndex = 0		End Sub	#tag EndEvent#tag EndEvents