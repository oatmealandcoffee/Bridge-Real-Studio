#tag WindowBegin Window WindowChangeKey   BackColor       =   16777215   Backdrop        =   ""   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   False   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   200   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   200   MaximizeButton  =   False   MaxWidth        =   400   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   200   MinimizeButton  =   True   MinWidth        =   400   Placement       =   0   Resizeable      =   False   Title           =   "Change Key"   Visible         =   True   Width           =   400   Begin Label ST_Key      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Key"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      Top             =   14      Underline       =   ""      Visible         =   True      Width           =   100   End   Begin PopupMenu PM_Key      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   132      ListIndex       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   13      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PushButton Cancel_PB      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "Cancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   208      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   160      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PushButton OK_PB      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "OK"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   300      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   160      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin Label ST_Type      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Type"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      Top             =   45      Underline       =   ""      Visible         =   True      Width           =   100   End   Begin PopupMenu PM_Type      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   ""      Italic          =   ""      Left            =   132      ListIndex       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      Top             =   44      Underline       =   ""      Visible         =   True      Width           =   156   EndEnd#tag EndWindow#tag WindowCode	#tag Method, Flags = &h0		Sub ChangeKey()		  dim settings as integer		  		  settings = &h00000000 //this is probably unecessary		  		  Select Case PM_Key.ListIndex		  Case 0'"C"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_C, settings)		  Case 1'"C#/Db"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_CsharpDflat, settings)		  Case 2'"D"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_D, settings)		  Case 3'"D#/Eb"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_DsharpEflat, settings)		  Case 4'"E"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_E, settings)		  Case 5'"F"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_F, settings)		  Case 6'"F#/Gb"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_FsharpGflat, settings)		  Case 7'"G"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_G, settings)		  Case 8'"G#/Ab"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_GsharpAFlat, settings)		  Case 9'"A"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_A, settings)		  Case 10'"A#/Bb"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_AsharpBflat, settings)		  Case 11'"B"		    settings = DataLib.SetFlag(DataLib.kFlagKeyType_B, settings)		  End Select		  		  Select Case PM_Type.ListIndex		  Case 0 '"Major")		    settings = DataLib.SetFlag(DataLib.kFlagKeyMod_Major, settings)		  Case 1 'Separator		  Case 2 '"Minor")		    settings = DataLib.SetFlag(DataLib.kFlagKeyMod_Minor, settings)		  Case 3 '"Harmonic Minor")		    settings = DataLib.SetFlag(DataLib.kFlagKeyMod_MinorHarmonic, settings)		  Case 4 '"Melodic Minor")		    settings = DataLib.SetFlag(DataLib.kFlagKeyMod_MinorMelodic, settings)		  Case 5 'Separator		  Case 6 '"Pentatonic Major")		    settings = DataLib.SetFlag(DataLib.kFlagKeyMod_PentatonicMajor, settings)		  Case 7 '"Pentatonic Minor")		    settings = DataLib.SetFlag(DataLib.kFlagKeyMod_PentatonicMinor, settings)		  End Select		  		  ParentWindow.EditMgr.ChangeKey(Settings)		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub GetKey(Key As KeyObj)		  if DataLib.GetFlag(DataLib.kFlagKeyType_C, Key.Settings) then self.PM_Key.ListIndex = 0		  if DataLib.GetFlag(DataLib.kFlagKeyType_CsharpDflat, Key.Settings) then self.PM_Key.ListIndex = 1		  if DataLib.GetFlag(DataLib.kFlagKeyType_D, Key.Settings) then self.PM_Key.ListIndex = 2		  if DataLib.GetFlag(DataLib.kFlagKeyType_DsharpEflat, Key.Settings) then self.PM_Key.ListIndex = 3		  if DataLib.GetFlag(DataLib.kFlagKeyType_E, Key.Settings) then self.PM_Key.ListIndex = 4		  if DataLib.GetFlag(DataLib.kFlagKeyType_F, Key.Settings) then self.PM_Key.ListIndex = 5		  if DataLib.GetFlag(DataLib.kFlagKeyType_FsharpGflat, Key.Settings) then self.PM_Key.ListIndex = 6		  if DataLib.GetFlag(DataLib.kFlagKeyType_G, Key.Settings) then self.PM_Key.ListIndex = 7		  if DataLib.GetFlag(DataLib.kFlagKeyType_GsharpAFlat, Key.Settings) then self.PM_Key.ListIndex = 8		  if DataLib.GetFlag(DataLib.kFlagKeyType_A, Key.Settings) then self.PM_Key.ListIndex = 9		  if DataLib.GetFlag(DataLib.kFlagKeyType_AsharpBflat, Key.Settings) then self.PM_Key.ListIndex = 10		  if DataLib.GetFlag(DataLib.kFlagKeyType_B, Key.Settings) then self.PM_Key.ListIndex = 11		  		  if DataLib.GetFlag(DataLib.kFlagKeyMod_Major, Key.Settings) then self.PM_Type.ListIndex = 0		  if DataLib.GetFlag(DataLib.kFlagKeyMod_Minor, Key.Settings) then self.PM_Type.ListIndex = 2		  if DataLib.GetFlag(DataLib.kFlagKeyMod_MinorHarmonic, Key.Settings) then self.PM_Type.ListIndex = 3		  if DataLib.GetFlag(DataLib.kFlagKeyMod_MinorMelodic, Key.Settings) then self.PM_Type.ListIndex = 4		  		  if DataLib.GetFlag(DataLib.kFlagKeyMod_PentatonicMajor, Key.Settings) then self.PM_Type.ListIndex = 6		  if DataLib.GetFlag(DataLib.kFlagKeyMod_PentatonicMinor, Key.Settings) then self.PM_Type.ListIndex = 7		End Sub	#tag EndMethod	#tag Property, Flags = &h0		ParentWindow As WindowEditor	#tag EndProperty#tag EndWindowCode#tag Events PM_Key	#tag Event		Sub Open()		  me.AddRow("C")		  me.AddRow("C#/Db")		  me.AddRow("D")		  me.AddRow("D#/Eb")		  me.AddRow("E")		  me.AddRow("F")		  me.AddRow("F#/Gb")		  me.AddRow("G")		  me.AddRow("G#/Ab")		  me.AddRow("A")		  me.AddRow("A#/Bb")		  me.AddRow("B")		  		  me.ListIndex = 0		End Sub	#tag EndEvent#tag EndEvents#tag Events Cancel_PB	#tag Event		Sub Action()		  self.Close		  ParentWindow.Show		End Sub	#tag EndEvent#tag EndEvents#tag Events OK_PB	#tag Event		Sub Action()		  ChangeKey		  self.Close		  ParentWindow.Show		End Sub	#tag EndEvent#tag EndEvents#tag Events PM_Type	#tag Event		Sub Open()		  me.AddRow("Major")		  me.AddSeparator		  me.AddRow("Minor")		  me.AddRow("Harmonic Minor")		  me.AddRow("Melodic Minor")		  'me.AddSeparator		  'me.AddRow("Pentatonic Major")		  'me.AddRow("Pentatonic Minor")		  		  Me.ListIndex = 0		End Sub	#tag EndEvent#tag EndEvents